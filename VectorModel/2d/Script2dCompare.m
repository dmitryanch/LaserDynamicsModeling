%%%% Simple script for VMB-system by etdrk3-method. Sigma, Delta and R 
%%%% parameters are tuned as infinite and finite aperture

clc
clear
%%
global x0 dx x Nr kfil r_aperture_ON sigma_aperture_ON a K
T=4e5;
t=0;
tau=1e-2;
Nt=ceil(T/tau);

r=2;
omega=1;
a=.01;
sigma=0.9;
b=0.1;
c=0.8;

Ne = 7; % number of equations
omega_aperture_ON = false;
sigma_aperture_ON = false;
r_aperture_ON = false;
lyapunov_ON = false;
k0=real(sqrt(omega/a));
diag=1;
Npolos=4;
if omega > 0
    L=2*pi/sqrt(omega/a/2)*Npolos;
else 
    L = 1;
end

h=L/128;
Nr=ceil(L/h);
stopfilename='stop1';
kfil=int32((Nr-1)/7*3)+1;

r_max=r;sigma_min=sigma;

l=2;
d=L;
dx=h;
x0=(0:Nr-1)*h;
[X Y]=meshgrid(x0);

%%% накачка - квадрат
if r_aperture_ON==1
    r=-1*ones(1,Nr);
    r(round(Nr/l*(l/2-0.5)):round(Nr/l*(l/2+0.5)))=r_max;
    r=smooth(r,1);  
end
if sigma_aperture_ON==1
    sigma=sigma_min*5*ones(1,Nr);
    sigma(round(Nr/l*(l/2-0.5)):round(Nr/l*(l/2+0.5)))=sigma_min;
    sigma=smooth(sigma,1);
end

%%%% накачка - круг
% r_max=r;sigma_min=sigma;
% for m=1:Nr 
%     for n=1:Nr
%         if (m-Nr/2-0.5)^2+(n-Nr/2-0.5)^2<=Nr^2/l^2/4
%             r(m,n)=r_max;   sigma(m,n)=sigma_min; 
%         else r(m,n)=0;sigma(m,n)=5*sigma_min;
%         end
%     end
% end
% r=smooth(r,1);
% sigma=smooth(sigma,1);
%%
n0=0.1;
% Ep0=smooth(n0*randn(Nr,Nr),1);
% Em0=smooth(n0*randn(Nr,Nr),1);
% Pp0=smooth(n0*randn(Nr,Nr),1);
% Pm0=smooth(n0*randn(Nr,Nr),1);
% Np0=smooth(n0*randn(Nr,Nr),1);
% Nm0=smooth(n0*randn(Nr,Nr),1);
% M0 =smooth(n0*randn(Nr,Nr),1);

%%%%%% Single Travelling co-waves
Ep0=sqrt(2*b*c/(3*c+b)*(r-1))*(exp(1i*(k0/sqrt(2)*(X+Y))));
Em0=sqrt(2*b*c/(3*c+b)*(r-1))*(exp(1i*(k0/sqrt(2)*(X+Y))));
Pp0=Ep0;
Pm0=Em0;
Np0=abs(Ep0).^2*3/2/b;
Nm0=abs(Ep0).^2*3/2/b;
M0=abs(Ep0).^2/2/c;

Epf=fft2(Ep0);
Emf=fft2(Em0);
Ppf=fft2(Pp0);
Pmf=fft2(Pm0);
Npf=fft2(Np0);
Nmf=fft2(Nm0);
Mf =fft2(M0);
Epf(1,1)=Epf(1,1)+1e-4;
Npf=makeReal2d(Npf);
Nmf=makeReal2d(Nmf);
Epf=filter2d(Epf);
Emf=filter2d(Emf);
Ppf=filter2d(Ppf);
Pmf=filter2d(Pmf);
Npf=filter2d(Npf);
Nmf=filter2d(Nmf);
Mf=filter2d(Mf);

% kx=linspace(-Nr/2,Nr/2,Nr)*2*pi/L;
kx=((-Nr/2):(Nr/2-1))*2*pi/L;
kx=fftshift(kx);
K=zeros(Nr,Nr);
for i=1:Nr
    for j=1:Nr
        K(i,j)=kx(i)^2+kx(j)^2;
    end
end
nstep=int32(0);
nrec=int32(0);
erow_incr=10;
nl=10;

SP=0;
SPar=[];
    
ID=int16(0);
filename=['INT2D omega=',num2str(omega),' r=',num2str(r_max),' sigma=',num2str(sigma_min),' b=',num2str(b),' a=',num2str(a),' dpi',num2str(Nr),' tau=',num2str(tau),' t=',num2str(t),' L=',num2str(L),' ID#',num2str(ID)];
while exist([filename,'.dat'], 'file')==2,
    ID=ID+1;
    filename=['INT2D omega=',num2str(omega),' r=',num2str(r_max),' sigma=',num2str(sigma_min),' b=',num2str(b),' a=',num2str(a),' dpi',num2str(Nr),' tau=',num2str(tau),' t=',num2str(t),' L=',num2str(L),' ID#',num2str(ID)];
end
datafilename=[filename,'.dat'];
%%% custom palette
grayCustom=[linspace(1,0,128);linspace(1,0,128);linspace(1,0,128)]';
init=zeros(Ne,Nr,Nr);
    init(1,:,:)=Epf;
    init(2,:,:)=Emf;
    init(3,:,:)=Ppf;
    init(4,:,:)=Pmf;
    init(5,:,:)=Npf;
    init(6,:,:)=Nmf;
    init(7,:,:)=Mf;
    
A=zeros(Ne,Nr,Nr);
B=zeros(Ne,Nr,Nr);
C=zeros(Ne,Nr,Nr);
DifF=[];
Diff=[];


%%%%% matrix's precomp
cc=zeros(Ne,Ne,Nr,Nr);ecc=zeros(Ne,Ne,Nr,Nr);ecc2=zeros(Ne,Ne,Nr,Nr);
for p=1:Nr
    for q=1:Nr
        cc(:,:,p,q)=[-sigma-1i*a*K(p,q),0,sigma,0,0,0,0;
            0,-sigma-1i*a*K(p,q),0,sigma,0,0,0;
            r,0,-1-1i*omega,0,0,0,0;
            0,r,0,-1-1i*omega,0,0,0;
            0,0,0,0,-b,0,0;
            0,0,0,0,0,-b,0;
            0,0,0,0,0,0,-c];

        ecc(:,:,p,q)=expm(cc(:,:,p,q)*tau);
        ecc2(:,:,p,q)=expm(cc(:,:,p,q)*0.5*tau);
    end
end
%     invc=inv(c);
ttau=tau;
ccc1=zeros(Ne,Ne,Nr,Nr);ccc2=zeros(Ne,Ne,Nr,Nr);ccc3=zeros(Ne,Ne,Nr,Nr);
for p=1:Nr
    for q=1:Nr
%         ccc1(:,:,p,q)=(-4*eye(Ne)-ttau*cc(:,:,p,q)+ecc(:,:,p,q)*(4*eye(Ne)-3*ttau*cc(:,:,p,q)+ttau^2*cc(:,:,p,q)^2))/ttau^2/cc(:,:,p,q)/cc(:,:,p,q)/cc(:,:,p,q);
%         ccc2(:,:,p,q)=(2*eye(Ne)+ttau*cc(:,:,p,q)+ecc(:,:,p,q)*(-2*eye(Ne)+ttau*cc(:,:,p,q)))/ttau^2/cc(:,:,p,q)/cc(:,:,p,q)/cc(:,:,p,q);
%         ccc3(:,:,p,q)=(-4*eye(Ne)-3*ttau*cc(:,:,p,q)-ttau^2*cc(:,:,p,q)^2+ecc(:,:,p,q)*(4*eye(Ne)-ttau*cc(:,:,p,q)))/ttau^2/cc(:,:,p,q)/cc(:,:,p,q)/cc(:,:,p,q);
        
        ccc1(:,:,p,q) = -4/ttau^2*(cc(:,:,p,q)^-1)^3 - 1/ttau*(cc(:,:,p,q)^-1)^2 + ecc(:,:,p,q)*4/ttau^2*(cc(:,:,p,q)^-1)^3 - ecc(:,:,p,q)*3/ttau*(cc(:,:,p,q)^-1)^2 + ecc(:,:,p,q)*(cc(:,:,p,q)^-1);
        ccc2(:,:,p,q) = 2/ttau^2*(cc(:,:,p,q)^-1)^3 + 1/ttau*(cc(:,:,p,q)^-1)^2 + ecc(:,:,p,q)*(-2)/ttau^2*(cc(:,:,p,q)^-1)^3 + ecc(:,:,p,q)/ttau*(cc(:,:,p,q)^-1)^2;
        ccc3(:,:,p,q) = -4/ttau^2*(cc(:,:,p,q)^-1)^3 - 3/ttau*(cc(:,:,p,q)^-1)^2 - cc(:,:,p,q)^-1 + ecc(:,:,p,q)*4/ttau^2*(cc(:,:,p,q)^-1)^3 - ecc(:,:,p,q)/ttau*(cc(:,:,p,q)^-1)^2;
    
    end
end
    
%%%%%
    
expM11=(exp(-tau./2).*exp(-(sigma.*tau)./2).*(exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2);
expM13=(2.*sigma.*exp(-tau./2).*exp(-(omega.*tau.*1i)./2).*exp(-(sigma.*tau)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2);

expM22=(exp(-tau./2).*exp(-(sigma.*tau)./2).*(exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2);
expM24=(2.*sigma.*exp(-tau./2).*exp(-(omega.*tau.*1i)./2).*exp(-(sigma.*tau)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2);

expM31=(2.*r.*exp(-tau./2).*exp(-(omega.*tau.*1i)./2).*exp(-(sigma.*tau)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2);
expM33=(exp(-tau./2).*exp(-(sigma.*tau)./2).*(- exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i + sigma.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2);

expM42=(2.*r.*exp(-tau./2).*exp(-(omega.*tau.*1i)./2).*exp(-(sigma.*tau)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2);
expM44=(exp(-tau./2).*exp(-(sigma.*tau)./2).*(- exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i + sigma.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2);

expM55=exp(-b.*tau);
expM66=exp(-b.*tau);
expM77=exp(-c.*tau);


exp2M11=(exp(-tau./4).*exp(-(sigma.*tau)./4).*(exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) + omega.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i - sigma.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) + exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2);
exp2M13=(2.*sigma.*exp(-tau./4).*exp(-(omega.*tau.*1i)./4).*exp(-(sigma.*tau)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2);

exp2M22=(exp(-tau./4).*exp(-(sigma.*tau)./4).*(exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) + omega.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i - sigma.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) + exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2);
exp2M24=(2.*sigma.*exp(-tau./4).*exp(-(omega.*tau.*1i)./4).*exp(-(sigma.*tau)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2);

exp2M31=(2.*r.*exp(-tau./4).*exp(-(omega.*tau.*1i)./4).*exp(-(sigma.*tau)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2);
exp2M33=(exp(-tau./4).*exp(-(sigma.*tau)./4).*(- exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) - omega.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i + sigma.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) + exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2);

exp2M42=(2.*r.*exp(-tau./4).*exp(-(omega.*tau.*1i)./4).*exp(-(sigma.*tau)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2);
exp2M44=(exp(-tau./4).*exp(-(sigma.*tau)./4).*(- exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) - omega.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i + sigma.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) + exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2);

exp2M55=exp(-b.*tau./2);
exp2M66=exp(-b.*tau./2);
exp2M77=exp(-c.*tau./2);


invM11=-(1 + omega.*1i)./(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega);
invM13=-sigma./(sigma + K.*a.*1i + omega.*(sigma.*1i - K.*a) - r.*sigma);

invM22=-(1 + omega.*1i)./(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega);
invM24=-sigma./(sigma + K.*a.*1i + omega.*(sigma.*1i - K.*a) - r.*sigma);

invM31=-r./(K.*a.*1i + sigma.*(omega.*1i - r + 1) - K.*a.*omega);
invM33=-(sigma + K.*a.*1i)./(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega);

invM42=-r./(K.*a.*1i + sigma.*(omega.*1i - r + 1) - K.*a.*omega);
invM44=-(sigma + K.*a.*1i)./(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega);

invM55=-1./b;
invM66=-1./b;
invM77=-1./c;

% a2=simplify((exp2M-eye(7)).*invM,'Steps',200)
a211=- ((1 + omega.*1i).*((exp(-tau./4).*exp(-(sigma.*tau)./4).*(exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) + omega.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i - sigma.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) + exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2) - 1))./(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega) - (2.*r.*sigma.*exp(-tau./4).*exp(-(omega.*tau.*1i)./4).*exp(-(sigma.*tau)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4))./((K.*a.*1i + sigma.*(omega.*1i - r + 1) - K.*a.*omega).*(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2));
a213=-(sigma.*exp(-tau./4).*exp(-(omega.*tau.*1i)./4).*exp(-(sigma.*tau)./4).*exp(-(K.*a.*tau.*1i)./4).*(sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) + cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + omega.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i + sigma.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) + K.*a.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i - exp(tau./4).*exp((omega.*tau.*1i)./4).*exp((sigma.*tau)./4).*exp((K.*a.*tau.*1i)./4).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2));

a222=- ((1 + omega.*1i).*((exp(-tau./4).*exp(-(sigma.*tau)./4).*(exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) + omega.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i - sigma.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) + exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2) - 1))./(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega) - (2.*r.*sigma.*exp(-tau./4).*exp(-(omega.*tau.*1i)./4).*exp(-(sigma.*tau)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4))./((K.*a.*1i + sigma.*(omega.*1i - r + 1) - K.*a.*omega).*(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2));
a224=-(sigma.*exp(-tau./4).*exp(-(omega.*tau.*1i)./4).*exp(-(sigma.*tau)./4).*exp(-(K.*a.*tau.*1i)./4).*(sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) + cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + omega.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i + sigma.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) + K.*a.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i - exp(tau./4).*exp((omega.*tau.*1i)./4).*exp((sigma.*tau)./4).*exp((K.*a.*tau.*1i)./4).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2));

a231=-(r.*exp(-tau./4).*exp(-(omega.*tau.*1i)./4).*exp(-(sigma.*tau)./4).*exp(-(K.*a.*tau.*1i)./4).*(sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) + cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + omega.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i + sigma.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) + K.*a.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i - exp(tau./4).*exp((omega.*tau.*1i)./4).*exp((sigma.*tau)./4).*exp((K.*a.*tau.*1i)./4).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2));
a233=- (((exp(-tau./4).*exp(-(sigma.*tau)./4).*(- exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) - omega.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i + sigma.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) + exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2) - 1).*(sigma + K.*a.*1i))./(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega) - (2.*r.*sigma.*exp(-tau./4).*exp(-(omega.*tau.*1i)./4).*exp(-(sigma.*tau)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4))./((sigma + K.*a.*1i + omega.*(sigma.*1i - K.*a) - r.*sigma).*(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2));

a242=-(r.*exp(-tau./4).*exp(-(omega.*tau.*1i)./4).*exp(-(sigma.*tau)./4).*exp(-(K.*a.*tau.*1i)./4).*(sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) + cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + omega.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i + sigma.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) + K.*a.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i - exp(tau./4).*exp((omega.*tau.*1i)./4).*exp((sigma.*tau)./4).*exp((K.*a.*tau.*1i)./4).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2));
a244=- (((exp(-tau./4).*exp(-(sigma.*tau)./4).*(- exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) - omega.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i + sigma.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4) + exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(omega.*tau.*1i)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4).*1i))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2) - 1).*(sigma + K.*a.*1i))./(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega) - (2.*r.*sigma.*exp(-tau./4).*exp(-(omega.*tau.*1i)./4).*exp(-(sigma.*tau)./4).*exp(-(K.*a.*tau.*1i)./4).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./4))./((sigma + K.*a.*1i + omega.*(sigma.*1i - K.*a) - r.*sigma).*(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2));

a255=-(exp(-(b.*tau)./2) - 1)./b;
a266=-(exp(-(b.*tau)./2) - 1)./b;
a277=-(exp(-(c.*tau)./2) - 1)./c;

% b2=simplify((expM-eye(7)).*invM,'Steps',200)
b211=- ((1 + omega.*1i).*((exp(-tau./2).*exp(-(sigma.*tau)./2).*(exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2) - 1))./(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega) - (2.*r.*sigma.*exp(-tau./2).*exp(-(omega.*tau.*1i)./2).*exp(-(sigma.*tau)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2))./((K.*a.*1i + sigma.*(omega.*1i - r + 1) - K.*a.*omega).*(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2));
b213=-(sigma.*exp(-tau./2).*exp(-(omega.*tau.*1i)./2).*exp(-(sigma.*tau)./2).*exp(-(K.*a.*tau.*1i)./2).*(sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + omega.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i + sigma.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + K.*a.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(tau./2).*exp((omega.*tau.*1i)./2).*exp((sigma.*tau)./2).*exp((K.*a.*tau.*1i)./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2));

b222=- ((1 + omega.*1i).*((exp(-tau./2).*exp(-(sigma.*tau)./2).*(exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2) - 1))./(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega) - (2.*r.*sigma.*exp(-tau./2).*exp(-(omega.*tau.*1i)./2).*exp(-(sigma.*tau)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2))./((K.*a.*1i + sigma.*(omega.*1i - r + 1) - K.*a.*omega).*(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2));
b224=-(sigma.*exp(-tau./2).*exp(-(omega.*tau.*1i)./2).*exp(-(sigma.*tau)./2).*exp(-(K.*a.*tau.*1i)./2).*(sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + omega.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i + sigma.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + K.*a.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(tau./2).*exp((omega.*tau.*1i)./2).*exp((sigma.*tau)./2).*exp((K.*a.*tau.*1i)./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2));

b231=-(r.*exp(-tau./2).*exp(-(omega.*tau.*1i)./2).*exp(-(sigma.*tau)./2).*exp(-(K.*a.*tau.*1i)./2).*(sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + omega.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i + sigma.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + K.*a.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(tau./2).*exp((omega.*tau.*1i)./2).*exp((sigma.*tau)./2).*exp((K.*a.*tau.*1i)./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2));
b233=- (((exp(-tau./2).*exp(-(sigma.*tau)./2).*(- exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i + sigma.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2) - 1).*(sigma + K.*a.*1i))./(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega) - (2.*r.*sigma.*exp(-tau./2).*exp(-(omega.*tau.*1i)./2).*exp(-(sigma.*tau)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2))./((sigma + K.*a.*1i + omega.*(sigma.*1i - K.*a) - r.*sigma).*(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2));

b242=-(r.*exp(-tau./2).*exp(-(omega.*tau.*1i)./2).*exp(-(sigma.*tau)./2).*exp(-(K.*a.*tau.*1i)./2).*(sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + omega.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i + sigma.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + K.*a.*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(tau./2).*exp((omega.*tau.*1i)./2).*exp((sigma.*tau)./2).*exp((K.*a.*tau.*1i)./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2));
b244=- (((exp(-tau./2).*exp(-(sigma.*tau)./2).*(- exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i + sigma.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(omega.*tau.*1i)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2) - 1).*(sigma + K.*a.*1i))./(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega) - (2.*r.*sigma.*exp(-tau./2).*exp(-(omega.*tau.*1i)./2).*exp(-(sigma.*tau)./2).*exp(-(K.*a.*tau.*1i)./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2))./((sigma + K.*a.*1i + omega.*(sigma.*1i - K.*a) - r.*sigma).*(4.*r.*sigma - omega.*sigma.*2i - 2.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + 1 - K.*a.*2i + omega.*2i + K.*a.*sigma.*2i).^(1./2));

b255=-(exp(-b.*tau) - 1)./b;
b266=-(exp(-b.*tau) - 1)./b;
b277=-(exp(-c.*tau) - 1)./c;

% c1=simplify(-4./tau.^2.*invM.^3 - 1./tau.*invM.^2 + expM.*4./tau.^2.*invM.^3 - expM.*3./tau.*invM.^2 + expM.*invM,'Steps',200)
c111=(omega.*2i - omega.^2 + r.*sigma + 1)./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) + ((3.*omega - r.*sigma.*2i - r.*sigma.^2.*1i + omega.^2.*3i - omega.^3 + 2.*omega.*r.*sigma + K.*a.*r.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) - (exp(-(tau.*(sigma + 1))./2).*(omega.*1i + 1).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (exp(-(tau.*(sigma + 1))./2).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(3.*omega - r.*sigma.*2i - r.*sigma.^2.*1i + omega.^2.*3i - omega.^3 + 2.*omega.*r.*sigma + K.*a.*r.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (3.*exp(-(tau.*(sigma + 1))./2).*(omega.*2i - omega.^2 + r.*sigma + 1).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (2.*r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (6.*r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*8i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));
c113=(sigma.*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) + (sigma.*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) - (sigma.*exp(-(tau.*(sigma + 1))./2).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (sigma.*exp(-(tau.*(sigma + 1))./2).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (3.*sigma.*exp(-(tau.*(sigma + 1))./2).*(omega.*1i + sigma + K.*a.*1i + 1).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (2.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(sigma + K.*a.*1i).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(r.*sigma.*1i + r.*sigma.^2.*2i + K.^3.*a.^3 + sigma.^3.*1i - K.^2.*a.^2.*sigma.*3i - omega.*r.*sigma - 3.*K.*a.*sigma.^2 - 2.*K.*a.*r.*sigma).*8i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (6.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(K.*a.*sigma.*2i - K.^2.*a.^2 + sigma.^2 + r.*sigma))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));

c122=(omega.*2i - omega.^2 + r.*sigma + 1)./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) + ((3.*omega - r.*sigma.*2i - r.*sigma.^2.*1i + omega.^2.*3i - omega.^3 + 2.*omega.*r.*sigma + K.*a.*r.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) - (exp(-(tau.*(sigma + 1))./2).*(omega.*1i + 1).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (exp(-(tau.*(sigma + 1))./2).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(3.*omega - r.*sigma.*2i - r.*sigma.^2.*1i + omega.^2.*3i - omega.^3 + 2.*omega.*r.*sigma + K.*a.*r.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (3.*exp(-(tau.*(sigma + 1))./2).*(omega.*2i - omega.^2 + r.*sigma + 1).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (2.*r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (6.*r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*8i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));
c124=(sigma.*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) + (sigma.*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) - (sigma.*exp(-(tau.*(sigma + 1))./2).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (sigma.*exp(-(tau.*(sigma + 1))./2).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (3.*sigma.*exp(-(tau.*(sigma + 1))./2).*(omega.*1i + sigma + K.*a.*1i + 1).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (2.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(sigma + K.*a.*1i).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(r.*sigma.*1i + r.*sigma.^2.*2i + K.^3.*a.^3 + sigma.^3.*1i - K.^2.*a.^2.*sigma.*3i - omega.*r.*sigma - 3.*K.*a.*sigma.^2 - 2.*K.*a.*r.*sigma).*8i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (6.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(K.*a.*sigma.*2i - K.^2.*a.^2 + sigma.^2 + r.*sigma))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));

c131=(r.*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) + (r.*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) - (r.*exp(-(tau.*(sigma + 1))./2).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (r.*exp(-(tau.*(sigma + 1))./2).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (3.*r.*exp(-(tau.*(sigma + 1))./2).*(omega.*1i + sigma + K.*a.*1i + 1).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (2.*r.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*1i + 1).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (6.*r.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(omega.*2i - omega.^2 + r.*sigma + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (r.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(3.*omega - r.*sigma.*2i - r.*sigma.^2.*1i + omega.^2.*3i - omega.^3 + 2.*omega.*r.*sigma + K.*a.*r.*sigma - 1i).*8i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));
c133=(K.*a.*sigma.*2i - K.^2.*a.^2 + sigma.^2 + r.*sigma)./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) - ((r.*sigma.*1i + r.*sigma.^2.*2i + K.^3.*a.^3 + sigma.^3.*1i - K.^2.*a.^2.*sigma.*3i - omega.*r.*sigma - 3.*K.*a.*sigma.^2 - 2.*K.*a.*r.*sigma).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) - (exp(-(tau.*(sigma + 1))./2).*(sigma + K.*a.*1i).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (3.*exp(-(tau.*(sigma + 1))./2).*(K.*a.*sigma.*2i - K.^2.*a.^2 + sigma.^2 + r.*sigma).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (exp(-(tau.*(sigma + 1))./2).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(r.*sigma.*1i + r.*sigma.^2.*2i + K.^3.*a.^3 + sigma.^3.*1i - K.^2.*a.^2.*sigma.*3i - omega.*r.*sigma - 3.*K.*a.*sigma.^2 - 2.*K.*a.*r.*sigma).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (2.*r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (6.*r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*8i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));

c142=(r.*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) + (r.*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) - (r.*exp(-(tau.*(sigma + 1))./2).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (r.*exp(-(tau.*(sigma + 1))./2).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (3.*r.*exp(-(tau.*(sigma + 1))./2).*(omega.*1i + sigma + K.*a.*1i + 1).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (2.*r.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*1i + 1).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (6.*r.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(omega.*2i - omega.^2 + r.*sigma + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (r.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(3.*omega - r.*sigma.*2i - r.*sigma.^2.*1i + omega.^2.*3i - omega.^3 + 2.*omega.*r.*sigma + K.*a.*r.*sigma - 1i).*8i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));
c144=(K.*a.*sigma.*2i - K.^2.*a.^2 + sigma.^2 + r.*sigma)./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) - ((r.*sigma.*1i + r.*sigma.^2.*2i + K.^3.*a.^3 + sigma.^3.*1i - K.^2.*a.^2.*sigma.*3i - omega.*r.*sigma - 3.*K.*a.*sigma.^2 - 2.*K.*a.*r.*sigma).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) - (exp(-(tau.*(sigma + 1))./2).*(sigma + K.*a.*1i).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (3.*exp(-(tau.*(sigma + 1))./2).*(K.*a.*sigma.*2i - K.^2.*a.^2 + sigma.^2 + r.*sigma).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (exp(-(tau.*(sigma + 1))./2).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(r.*sigma.*1i + r.*sigma.^2.*2i + K.^3.*a.^3 + sigma.^3.*1i - K.^2.*a.^2.*sigma.*3i - omega.*r.*sigma - 3.*K.*a.*sigma.^2 - 2.*K.*a.*r.*sigma).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (2.*r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i))./((sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (6.*r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*8i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));

c155=- exp(-b.*tau)./b - (4.*exp(-b.*tau) + b.*tau.*(3.*exp(-b.*tau) + 1) - 4)./(b.^3.*tau.^2);
c166=- exp(-b.*tau)./b - (4.*exp(-b.*tau) + b.*tau.*(3.*exp(-b.*tau) + 1) - 4)./(b.^3.*tau.^2);
c177=- exp(-c.*tau)./c - (4.*exp(-c.*tau) + c.*tau.*(3.*exp(-c.*tau) + 1) - 4)./(c.^3.*tau.^2);

% c2=simplify(2./tau.^2.*invM.^3 + 1./tau.*invM.^2 + expM.*(-2)./tau.^2.*invM.^3 + expM./tau.*invM.^2,'Steps',200)
c211=(exp(-(tau.*(sigma + 1))./2).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(3.*omega - r.*sigma.*2i - r.*sigma.^2.*1i + omega.^2.*3i - omega.^3 + 2.*omega.*r.*sigma + K.*a.*r.*sigma - 1i).*2i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - ((3.*omega - r.*sigma.*2i - r.*sigma.^2.*1i + omega.^2.*3i - omega.^3 + 2.*omega.*r.*sigma + K.*a.*r.*sigma - 1i).*2i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) - (omega.*2i - omega.^2 + r.*sigma + 1)./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) - (exp(-(tau.*(sigma + 1))./2).*(omega.*2i - omega.^2 + r.*sigma + 1).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (2.*r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));
c213=(sigma.*exp(-(tau.*(sigma + 1))./2).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*2i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (sigma.*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) - (sigma.*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*2i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) - (sigma.*exp(-(tau.*(sigma + 1))./2).*(omega.*1i + sigma + K.*a.*1i + 1).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(r.*sigma.*1i + r.*sigma.^2.*2i + K.^3.*a.^3 + sigma.^3.*1i - K.^2.*a.^2.*sigma.*3i - omega.*r.*sigma - 3.*K.*a.*sigma.^2 - 2.*K.*a.*r.*sigma).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (2.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(K.*a.*sigma.*2i - K.^2.*a.^2 + sigma.^2 + r.*sigma))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));

c222=(exp(-(tau.*(sigma + 1))./2).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(3.*omega - r.*sigma.*2i - r.*sigma.^2.*1i + omega.^2.*3i - omega.^3 + 2.*omega.*r.*sigma + K.*a.*r.*sigma - 1i).*2i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - ((3.*omega - r.*sigma.*2i - r.*sigma.^2.*1i + omega.^2.*3i - omega.^3 + 2.*omega.*r.*sigma + K.*a.*r.*sigma - 1i).*2i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) - (omega.*2i - omega.^2 + r.*sigma + 1)./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) - (exp(-(tau.*(sigma + 1))./2).*(omega.*2i - omega.^2 + r.*sigma + 1).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (2.*r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));
c224=(sigma.*exp(-(tau.*(sigma + 1))./2).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*2i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (sigma.*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) - (sigma.*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*2i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) - (sigma.*exp(-(tau.*(sigma + 1))./2).*(omega.*1i + sigma + K.*a.*1i + 1).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(r.*sigma.*1i + r.*sigma.^2.*2i + K.^3.*a.^3 + sigma.^3.*1i - K.^2.*a.^2.*sigma.*3i - omega.*r.*sigma - 3.*K.*a.*sigma.^2 - 2.*K.*a.*r.*sigma).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (2.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(K.*a.*sigma.*2i - K.^2.*a.^2 + sigma.^2 + r.*sigma))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));

c231=(r.*exp(-(tau.*(sigma + 1))./2).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*2i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (r.*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) - (r.*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*2i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) - (r.*exp(-(tau.*(sigma + 1))./2).*(omega.*1i + sigma + K.*a.*1i + 1).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (2.*r.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(omega.*2i - omega.^2 + r.*sigma + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (r.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(3.*omega - r.*sigma.*2i - r.*sigma.^2.*1i + omega.^2.*3i - omega.^3 + 2.*omega.*r.*sigma + K.*a.*r.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));
c233=((r.*sigma.*1i + r.*sigma.^2.*2i + K.^3.*a.^3 + sigma.^3.*1i - K.^2.*a.^2.*sigma.*3i - omega.*r.*sigma - 3.*K.*a.*sigma.^2 - 2.*K.*a.*r.*sigma).*2i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) - (K.*a.*sigma.*2i - K.^2.*a.^2 + sigma.^2 + r.*sigma)./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) - (exp(-(tau.*(sigma + 1))./2).*(K.*a.*sigma.*2i - K.^2.*a.^2 + sigma.^2 + r.*sigma).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (exp(-(tau.*(sigma + 1))./2).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(r.*sigma.*1i + r.*sigma.^2.*2i + K.^3.*a.^3 + sigma.^3.*1i - K.^2.*a.^2.*sigma.*3i - omega.*r.*sigma - 3.*K.*a.*sigma.^2 - 2.*K.*a.*r.*sigma).*2i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (2.*r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));

c242=(r.*exp(-(tau.*(sigma + 1))./2).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*2i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (r.*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) - (r.*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*2i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) - (r.*exp(-(tau.*(sigma + 1))./2).*(omega.*1i + sigma + K.*a.*1i + 1).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (2.*r.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(omega.*2i - omega.^2 + r.*sigma + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (r.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(3.*omega - r.*sigma.*2i - r.*sigma.^2.*1i + omega.^2.*3i - omega.^3 + 2.*omega.*r.*sigma + K.*a.*r.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));
c244=((r.*sigma.*1i + r.*sigma.^2.*2i + K.^3.*a.^3 + sigma.^3.*1i - K.^2.*a.^2.*sigma.*3i - omega.*r.*sigma - 3.*K.*a.*sigma.^2 - 2.*K.*a.*r.*sigma).*2i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) - (K.*a.*sigma.*2i - K.^2.*a.^2 + sigma.^2 + r.*sigma)./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) - (exp(-(tau.*(sigma + 1))./2).*(K.*a.*sigma.*2i - K.^2.*a.^2 + sigma.^2 + r.*sigma).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (exp(-(tau.*(sigma + 1))./2).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(r.*sigma.*1i + r.*sigma.^2.*2i + K.^3.*a.^3 + sigma.^3.*1i - K.^2.*a.^2.*sigma.*3i - omega.*r.*sigma - 3.*K.*a.*sigma.^2 - 2.*K.*a.*r.*sigma).*2i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (2.*r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));

c255=(2.*exp(-b.*tau) + b.*tau.*(exp(-b.*tau) + 1) - 2)./(b.^3.*tau.^2);
c266=(2.*exp(-b.*tau) + b.*tau.*(exp(-b.*tau) + 1) - 2)./(b.^3.*tau.^2);
c277=(2.*exp(-c.*tau) + c.*tau.*(exp(-c.*tau) + 1) - 2)./(c.^3.*tau.^2);

% c3=simplify(-4./tau.^2.*invM.^3 - 3./tau.*invM.^2 - invM + expM.*4./tau.^2.*invM.^3 - expM./tau.*invM.^2,'Steps',200)
c311=(omega.*1i + 1)./(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega) + (3.*(omega.*2i - omega.^2 + r.*sigma + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) + ((3.*omega - r.*sigma.*2i - r.*sigma.^2.*1i + omega.^2.*3i - omega.^3 + 2.*omega.*r.*sigma + K.*a.*r.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) - (exp(-(tau.*(sigma + 1))./2).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(3.*omega - r.*sigma.*2i - r.*sigma.^2.*1i + omega.^2.*3i - omega.^3 + 2.*omega.*r.*sigma + K.*a.*r.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (exp(-(tau.*(sigma + 1))./2).*(omega.*2i - omega.^2 + r.*sigma + 1).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (2.*r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*8i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));
c313=sigma./(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega) + (sigma.*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) + (3.*sigma.*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) - (sigma.*exp(-(tau.*(sigma + 1))./2).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (sigma.*exp(-(tau.*(sigma + 1))./2).*(omega.*1i + sigma + K.*a.*1i + 1).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(r.*sigma.*1i + r.*sigma.^2.*2i + K.^3.*a.^3 + sigma.^3.*1i - K.^2.*a.^2.*sigma.*3i - omega.*r.*sigma - 3.*K.*a.*sigma.^2 - 2.*K.*a.*r.*sigma).*8i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (2.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(K.*a.*sigma.*2i - K.^2.*a.^2 + sigma.^2 + r.*sigma))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));

c322=(omega.*1i + 1)./(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega) + (3.*(omega.*2i - omega.^2 + r.*sigma + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) + ((3.*omega - r.*sigma.*2i - r.*sigma.^2.*1i + omega.^2.*3i - omega.^3 + 2.*omega.*r.*sigma + K.*a.*r.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) - (exp(-(tau.*(sigma + 1))./2).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(3.*omega - r.*sigma.*2i - r.*sigma.^2.*1i + omega.^2.*3i - omega.^3 + 2.*omega.*r.*sigma + K.*a.*r.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (exp(-(tau.*(sigma + 1))./2).*(omega.*2i - omega.^2 + r.*sigma + 1).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (2.*r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*8i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));
c324=sigma./(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega) + (sigma.*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) + (3.*sigma.*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) - (sigma.*exp(-(tau.*(sigma + 1))./2).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (sigma.*exp(-(tau.*(sigma + 1))./2).*(omega.*1i + sigma + K.*a.*1i + 1).*(exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) - K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(r.*sigma.*1i + r.*sigma.^2.*2i + K.^3.*a.^3 + sigma.^3.*1i - K.^2.*a.^2.*sigma.*3i - omega.*r.*sigma - 3.*K.*a.*sigma.^2 - 2.*K.*a.*r.*sigma).*8i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (2.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(K.*a.*sigma.*2i - K.^2.*a.^2 + sigma.^2 + r.*sigma))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));

c331=r./(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega) + (r.*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) + (3.*r.*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) - (r.*exp(-(tau.*(sigma + 1))./2).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (r.*exp(-(tau.*(sigma + 1))./2).*(omega.*1i + sigma + K.*a.*1i + 1).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (2.*r.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(omega.*2i - omega.^2 + r.*sigma + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (r.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(3.*omega - r.*sigma.*2i - r.*sigma.^2.*1i + omega.^2.*3i - omega.^3 + 2.*omega.*r.*sigma + K.*a.*r.*sigma - 1i).*8i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));
c333=(sigma + K.*a.*1i)./(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega) - ((r.*sigma.*1i + r.*sigma.^2.*2i + K.^3.*a.^3 + sigma.^3.*1i - K.^2.*a.^2.*sigma.*3i - omega.*r.*sigma - 3.*K.*a.*sigma.^2 - 2.*K.*a.*r.*sigma).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) + (3.*(K.*a.*sigma.*2i - K.^2.*a.^2 + sigma.^2 + r.*sigma))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) + (exp(-(tau.*(sigma + 1))./2).*(K.*a.*sigma.*2i - K.^2.*a.^2 + sigma.^2 + r.*sigma).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (exp(-(tau.*(sigma + 1))./2).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(r.*sigma.*1i + r.*sigma.^2.*2i + K.^3.*a.^3 + sigma.^3.*1i - K.^2.*a.^2.*sigma.*3i - omega.*r.*sigma - 3.*K.*a.*sigma.^2 - 2.*K.*a.*r.*sigma).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (2.*r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*8i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));

c342=r./(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega) + (r.*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) + (3.*r.*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) - (r.*exp(-(tau.*(sigma + 1))./2).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (r.*exp(-(tau.*(sigma + 1))./2).*(omega.*1i + sigma + K.*a.*1i + 1).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (2.*r.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(omega.*2i - omega.^2 + r.*sigma + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (r.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(3.*omega - r.*sigma.*2i - r.*sigma.^2.*1i + omega.^2.*3i - omega.^3 + 2.*omega.*r.*sigma + K.*a.*r.*sigma - 1i).*8i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));
c344=(sigma + K.*a.*1i)./(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega) - ((r.*sigma.*1i + r.*sigma.^2.*2i + K.^3.*a.^3 + sigma.^3.*1i - K.^2.*a.^2.*sigma.*3i - omega.*r.*sigma - 3.*K.*a.*sigma.^2 - 2.*K.*a.*r.*sigma).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3) + (3.*(K.*a.*sigma.*2i - K.^2.*a.^2 + sigma.^2 + r.*sigma))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2) + (exp(-(tau.*(sigma + 1))./2).*(K.*a.*sigma.*2i - K.^2.*a.^2 + sigma.^2 + r.*sigma).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (exp(-(tau.*(sigma + 1))./2).*(sigma.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) - omega.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i - exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2) + exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*cosh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2) + K.*a.*exp(-(tau.*(omega.*1i + K.*a.*1i))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*1i).*(r.*sigma.*1i + r.*sigma.^2.*2i + K.^3.*a.^3 + sigma.^3.*1i - K.^2.*a.^2.*sigma.*3i - omega.*r.*sigma - 3.*K.*a.*sigma.^2 - 2.*K.*a.*r.*sigma).*4i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) + (2.*r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(omega.*1i + sigma + K.*a.*1i + 1))./(tau.*(K.*a - sigma.*1i + omega.*sigma + r.*sigma.*1i + K.*a.*omega.*1i).^2.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2)) - (r.*sigma.*exp(-(tau.*(sigma + 1))./2).*sinh((tau.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2))./2).*(cos((tau.*(omega + K.*a))./2) - sin((tau.*(omega + K.*a))./2).*1i).*(2.*omega - sigma.*1i + K.*a + omega.*sigma - r.*sigma.*1i + K.^2.*a.^2.*1i + omega.^2.*1i - sigma.^2.*1i + K.*a.*omega.*1i + 2.*K.*a.*sigma - 1i).*8i)./(tau.^2.*(sigma + K.*a.*1i + omega.*sigma.*1i - r.*sigma - K.*a.*omega).^3.*(omega.*2i - 2.*sigma - K.*a.*2i - omega.*sigma.*2i + 4.*r.*sigma - K.^2.*a.^2 - omega.^2 + sigma.^2 + 2.*K.*a.*omega + K.*a.*sigma.*2i + 1).^(1./2));

c355=1./b - (4.*exp(-b.*tau) + b.*tau.*(exp(-b.*tau) + 3) - 4)./(b.^3.*tau.^2);
c366=1./b - (4.*exp(-b.*tau) + b.*tau.*(exp(-b.*tau) + 3) - 4)./(b.^3.*tau.^2);
c377=1./c - (4.*exp(-c.*tau) + c.*tau.*(exp(-c.*tau) + 3) - 4)./(c.^3.*tau.^2);
%%%%%

%%
ffttime=0;
nltime=0;
tstart=tic
% Dot=zeros(Nr,Nr);
if t==0, 
    erow=zeros(nl,1); 
end;

while round(t/tau)*tau<1e5*tau%6e4
    
    %%% matrix form
%     init(1,:,:)=Epf;
%     init(2,:,:)=Emf;
%     init(3,:,:)=Ppf;
%     init(4,:,:)=Pmf;
%     init(5,:,:)=Npf;
%     init(6,:,:)=Nmf;
%     init(7,:,:)=Mf;
    ntime=tic;
    [F, ep, em,f1]=nonlinear2d(init);
    nltime=nltime+toc(ntime);
    ffttime=ffttime+f1;
    for p=1:Nr
        for q=1:Nr
            A(:,p,q)=ecc2(:,:,p,q)*init(:,p,q)+(ecc2(:,:,p,q)-eye(Ne))/cc(:,:,p,q)*F(:,p,q);
        end
    end
    ntime=tic;
    [FA,ep,em,f1]=nonlinear2d(A);
    nltime=nltime+toc(ntime);
    ffttime=ffttime+f1;
    for p=1:Nr
        for q=1:Nr
            B(:,p,q)=ecc(:,:,p,q)*init(:,p,q)+(ecc(:,:,p,q)-eye(Ne))/cc(:,:,p,q)*(2*FA(:,p,q)-F(:,p,q));
        end
    end
    ntime=tic;
    [FB,ep,em,f1]=nonlinear2d(B);
    nltime=nltime+toc(ntime);
    ffttime=ffttime+f1;
    for p=1:Nr
        for q=1:Nr
            C(:,p,q)=ecc(:,:,p,q)*init(:,p,q)+ccc1(:,:,p,q)*F(:,p,q)+4*ccc2(:,:,p,q)*FA(:,p,q)+ccc3(:,:,p,q)*FB(:,p,q);
        end
    end
    
    

    init(1,:,:)=filter2d(C(1,:,:));
    init(2,:,:)=filter2d(C(2,:,:));
    init(3,:,:)=filter2d(C(3,:,:));
    init(4,:,:)=filter2d(C(4,:,:));
    init(5,:,:)=filter2d(C(5,:,:));
    init(6,:,:)=filter2d(C(6,:,:));
    init(7,:,:)=filter2d(C(7,:,:));
    
    
    %%%%
    [fEpf,fEmf,fPpf,fPmf,fNpf,fNmf,fMf]=nonlin2d(Epf,Emf,Ppf,Pmf,Npf,Nmf,Mf);
%     nltime=nltime+toc(ntime);
%     ffttime=ffttime+f1;
    aEpf=exp2M11.*Epf+exp2M13.*Ppf+a211.*fEpf+a213.*fPpf;
    aEmf=exp2M22.*Emf+exp2M24.*Pmf+a222.*fEmf+a224.*fPmf;
    aPpf=exp2M31.*Epf+exp2M33.*Ppf+a231.*fEpf+a233.*fPpf;
    aPmf=exp2M42.*Emf+exp2M44.*Pmf+a242.*fEmf+a244.*fPmf;
	aNpf=exp2M55.*Npf+a255.*fNpf;
	aNmf=exp2M66.*Nmf+a266.*fNmf;
	aMf=exp2M77.*Mf+a277.*fMf;
    
%     ntime=tic;
    [faEpf,faEmf,faPpf,faPmf,faNpf,faNmf,faMf]=nonlin2d(aEpf,aEmf,aPpf,aPmf,aNpf,aNmf,aMf);
%     nltime=nltime+toc(ntime);
%     ffttime=ffttime+f1;
	bEpf=expM11.*Epf+expM13.*Ppf+b211.*(2*faEpf-fEpf)+b213.*(2*faPpf-fPpf);
    bEmf=expM22.*Emf+expM24.*Pmf+b222.*(2*faEmf-fEmf)+b224.*(2*faPmf-fPmf);
    bPpf=expM31.*Epf+expM33.*Ppf+b231.*(2*faEpf-fEpf)+b233.*(2*faPpf-fPpf);
    bPmf=expM42.*Emf+expM44.*Pmf+b242.*(2*faEmf-fEmf)+b244.*(2*faPmf-fPmf);
	bNpf=expM55.*Npf+b255.*(2*faNpf-fNpf);
	bNmf=expM66.*Nmf+b266.*(2*faNmf-fNmf);
	bMf=expM77.*Mf+b277.*(2*faMf-fMf);
%     ntime=tic;
    [fbEpf,fbEmf,fbPpf,fbPmf,fbNpf,fbNmf,fbMf]=nonlin2d(bEpf,bEmf,bPpf,bPmf,bNpf,bNmf,bMf);
%     nltime=nltime+toc(ntime);
%     ffttime=ffttime+f1;
    cEpf=expM11.*Epf+expM13.*Ppf+c111.*fEpf+c113.*fPpf+4*c211.*faEpf+4*c213.*faPpf+c311.*fbEpf+c313.*fbPpf;
    cEmf=expM22.*Emf+expM24.*Pmf+c122.*fEmf+c124.*fPmf+4*c222.*faEmf+4*c224.*faPmf+c322.*fbEmf+c324.*fbPmf;
    cPpf=expM31.*Epf+expM33.*Ppf+c131.*fEpf+c133.*fPpf+4*c231.*faEpf+4*c233.*faPpf+c331.*fbEpf+c333.*fbPpf;
    cPmf=expM42.*Emf+expM44.*Pmf+c142.*fEmf+c144.*fPmf+4*c242.*faEmf+4*c244.*faPmf+c342.*fbEmf+c344.*fbPmf;
	cNpf=expM55.*Npf+c155.*fNpf+4*c255.*faNpf+c355.*fbNpf;
	cNmf=expM66.*Nmf+c166.*fNmf+4*c266.*faNmf+c366.*fbNmf;
	cMf=expM77.*Mf+c177.*fMf+4*c277.*faMf+c377.*fbMf;
    
    Epf=filter2d(cEpf);
    Emf=filter2d(cEmf);
    Ppf=filter2d(cPpf);
    Pmf=filter2d(cPmf);
    Npf=filter2d(cNpf);
    Nmf=filter2d(cNmf);
    Mf=filter2d(cMf);
    %%%%%
    
    nstep=nstep+int32(1);
    t=t+tau;
%     if abs(mod(nstep,int32(erow_incr)))<tau/2,
% %         dI=[dI (max(max(abs(Ecur).^2))-min(min(abs(Ecur).^2)))/max(max(abs(Ecur).^2))];
% %         disp(t);
% 
%         if(ep(1) ~= ep(1))
%             break;
%         end
%         nrec=nrec+1;
%         erow(nrec)=abs(ep(Nr/2))^2+abs(em(Nr/2))^2;%Ecur(round(Nr/2),round(Nr/2))];
%         
%         if nrec==nl, 
%     %         Erow=[Erow erow];erow=[];%DI=[DI dI];dI=[]; % Imax=[Imax imax];imax=[];
%     %         disp('write center');
%             disp(['t= ',num2str(t),' at ',num2str(toc),' s']);
%             disp(['I= ',num2str(erow(nrec))]);
%             fid = fopen(datafilename, 'a');
%             fwrite(fid, erow, 'double');
%             fclose(fid); 
%             nrec=int32(0);   % запись матрицы в файл (40 байт)
%             if exist(stopfilename,'file')==2,
%                 break;
%             end
%         end
%         imagesc(abs(ep).^2+abs(em).^2);
%         drawnow;
%     end
    
%     plot(1:Nr,abs(ep).^2+abs(em).^2);
%     title(t);
%     drawnow;

Diff=[Diff max(max(abs(reshape(init(1,:,:),Nr,Nr)-Epf)))];
plot(Diff);
    title(t);
    drawnow;
end
toc(tstart);

%%
if nrec>0, 
%     Erow=[Erow erow];erow=[];  DI=[DI dI];dI=[]; Imax=[Imax imax];imax=[]; 
%     disp('write end');
    fid = fopen(datafilename, 'a');
    fwrite(fid, erow(1:nrec), 'double');
    fclose(fid); 
%     disp(nrec);
    nrec=int32(0);
    erow=zeros(nl,1);
end;


%%
% INT=[];
% fid = fopen(datafilename, 'rb');
% INT = fread(fid, 'double'); 
% fclose(fid); 
% figure;plot((1:numel(INT))*erow_incr*tau,INT);
% title(['omega=',num2str(omega),' r=',num2str(r_max),' sigma=',num2str(sigma_min),' b=',num2str(b),' a=',num2str(a)]);
% filename=['Int(t) 2D omega=',num2str(omega),' r=',num2str(r_max),' sigma=',num2str(sigma_min),' b=',num2str(b),' a=',num2str(a),' dpi',num2str(Nr),' tau=',num2str(tau),' t=',num2str(t),' L=',num2str(L),' ID#',num2str(ID),'.jpg'];
% xlabel('Время t');ylabel('Уровень интенсивности I=|E|^2');saveas(gcf,filename,'jpg');close gcf;
